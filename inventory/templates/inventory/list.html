{% extends "base.html" %}

{% block title %}åœ¨åº«{% endblock %}

{% block content %}
<!--
åœ¨åº«ä¸€è¦§ãƒšãƒ¼ã‚¸ï¼ˆinventory/list.htmlï¼‰

ç›®çš„ï¼š
- base.html ã‚’ç¶™æ‰¿ã—ã¦ã€å…¨ãƒšãƒ¼ã‚¸å…±é€šã®ãƒŠãƒ“ï¼ˆåœ¨åº«/ãƒ¡ãƒ¢/ç®¡ç†/ãƒ­ã‚°ã‚¢ã‚¦ãƒˆï¼‰ã‚’è¡¨ç¤ºã™ã‚‹
- åœ¨åº«ã‚’ä¸€è¦§è¡¨ç¤ºã—ã€ã‚«ãƒ†ã‚´ãƒªæœªè¨­å®šã®å ´åˆã¯ã€Œæœªåˆ†é¡ã€ã¨è¡¨ç¤ºã™ã‚‹
- ä¸€è¦§ã®å…ˆé ­ã«ã€Œåœ¨åº«ã‚’è¿½åŠ ã€ãƒªãƒ³ã‚¯ã‚’ç½®ã
-->

<h1>åœ¨åº«ä¸€è¦§</h1>
<!-- ----------------------------
ã‚«ãƒ†ã‚´ãƒªçµã‚Šè¾¼ã¿ãƒ•ã‚©ãƒ¼ãƒ 
- method="get" ã«ã™ã‚‹ã¨URLã« ?category= ãŒä»˜ã
- selected_category ã¨ categories ã‚’ä½¿ã£ã¦ãƒ—ãƒ«ãƒ€ã‚¦ãƒ³ã‚’ä½œã‚‹
----------------------------- -->
<form method="get">

  <!-- åˆ†é¡ -->
  <label>åˆ†é¡</label>
  <select name="category">
    <option value="">ã™ã¹ã¦</option>
    {% for c in categories %}
      <option value="{{ c.id }}"
        {% if selected_category == c.id|stringformat:"s" %}
          selected
        {% endif %}
      >
        {{ c.name }}
      </option>
    {% endfor %}
  </select>

  <!-- ä¿ç®¡å ´æ‰€ï¼ˆä»Šå›è¿½åŠ ï¼‰ -->
  <label>ä¿ç®¡å ´æ‰€</label>
  <select name="storage">
    <option value="">ã™ã¹ã¦</option>
    {% for s in storages %}
      <option value="{{ s.id }}"
        {% if selected_storage == s.id|stringformat:"s" %}
          selected
        {% endif %}
      >
        {{ s.name }}
      </option>
    {% endfor %}
  </select>

  <button class="btn" type="submit">çµã‚Šè¾¼ã¿</button>

  <!-- çµã‚Šè¾¼ã¿è§£é™¤ï¼ˆcategoryãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ç„¡ã—ã§ /inventory/ ã«æˆ»ã™ï¼‰ -->
  <a class="btn" href="{% url 'inventory:inventory_list' %}">è§£é™¤</a>
</form>

<hr>

<!--
ä¸€è¦§ã®é›†è¨ˆè¡¨ç¤º
- Viewå´ã§ total_items / total_quantity ã‚’æ¸¡ã—ã¦ã„ã‚‹ã®ã§ã“ã“ã§è¡¨ç¤ºã§ãã‚‹
-->
<p>
  åˆè¨ˆï¼š{{ total_items }}ä»¶ / æ•°é‡åˆè¨ˆï¼š{{ total_quantity }}
</p>

<!-- åœ¨åº«è¿½åŠ ãƒªãƒ³ã‚¯ï¼ˆurls.py ã® name="inventory_add" ã‚’å‚ç…§ï¼‰ -->
<p><a href="{% url 'inventory:inventory_add' %}">ï¼‹åœ¨åº«ã‚’è¿½åŠ </a></p>

{% for item in object_list %}
  <p>
    <!-- ã‚«ãƒ†ã‚´ãƒªè¡¨ç¤ºï¼šFKãªã®ã§ name ã‚’è¡¨ç¤ºï¼ˆæœªè¨­å®šãªã‚‰æœªåˆ†é¡ï¼‰ -->
    {% if item.category %}
      ã€{{ item.category.name }}ã€‘
    {% else %}
      ã€æœªåˆ†é¡ã€‘
    {% endif %}

    <!--â˜… ã‚¢ãƒ©ãƒ¼ãƒˆè¡¨ç¤ºï¼ˆèµ¤å„ªå…ˆï¼‰-->
    {% if item.is_alert_red %}
      <span style="color: red; font-weight: bold;">ğŸ””</span>
    {% elif item.is_alert_blue %}
      <span style="color: blue; font-weight: bold;">ğŸ””</span>
    {% endif %}

    <span
      {% if item.is_alert_red %}
        style="color: red; font-weight: bold;"
      {% elif item.is_alert_blue %}
        style="color: blue; font-weight: bold;"
      {% endif %}
    >    
      {{ item.name }}
    </span>
    /
    {{ item.quantity }}

    {# â˜…è¿½åŠ ï¼šè³å‘³æœŸé™ã®è¡¨ç¤ºï¼ˆæœªè¨­å®šãªã‚‰éè¡¨ç¤ºã§OKï¼‰ #}
    {% if item.expiry_date %}
      <small>ï¼ˆè³å‘³æœŸé™ï¼š{{ item.expiry_date|date:"Y-m-d" }}ï¼‰</small>
    {% endif %}

    {# ã‚ã¨ä½•æ—¥ï¼ˆViewã§days_leftä»˜ä¸æ¸ˆã¿æƒ³å®šï¼‰ #}
    {% if item.days_left is not None %}
      <small>ï¼ˆã‚ã¨{{ item.days_left }}æ—¥ï¼‰</small>
    {% endif %}

    {% if item.storage_location %}
      ï¼ˆ{{ item.storage_location.name }}ï¼‰
    {% else %}
      ï¼ˆä¿ç®¡å ´æ‰€æœªè¨­å®šï¼‰
    {% endif %}

    <a href="{% url 'inventory:inventory_edit' item.pk %}">ç·¨é›†</a>
    <a href="{% url 'inventory:inventory_delete' item.pk %}">å‰Šé™¤</a>
    </p>

{% empty %}
  <p>åœ¨åº«ãŒã¾ã ã‚ã‚Šã¾ã›ã‚“ã€‚</p>
{% endfor %}

{% endblock %}